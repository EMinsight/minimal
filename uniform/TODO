move allocate to constructor
fuse all triple loops for periodic
MD driver code with VdW